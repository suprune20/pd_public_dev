<!doctype html>
<html ng-app="pdApp">
  <head>
    <meta charset="utf-8">
    <base href="/">
    <meta name="fragment" content="!"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title ng-bind-template="Похоронное Дело {{ seo.getTitle() ? '- ' + seo.getTitle() : '' }}">Похоронное дело</title>
    <meta name="description" ng-attr-content="{{ seo.getDescription() }}">
    <meta name="keywords" ng-attr-content="{{ seo.getKeywords() }}">
    <meta name="viewport" content="width=device-width">

    <!-- build:css styles/vendor.css -->
    <!-- bower:css -->
    <link rel="stylesheet" href="bower_components/select2/select2.css" />
    <!-- endbower -->
    <link rel="stylesheet" href="bower_components/angular-growl/build/angular-growl.min.css"/>
    <link rel="stylesheet" href="bower_components/fancybox/source/jquery.fancybox.css"/>
    <link rel="stylesheet" href="bower_components/fancybox/source/helpers/jquery.fancybox-thumbs.css"/>
    <!-- endbuild -->

    <!-- build:css({.tmp,app}) styles/main.css -->
    <link rel="stylesheet" href="styles/main.css">
    <!-- endbuild -->

    <link rel="icon" type="image/png" href="favicon.png" />

    <script>
      // Redirect all links (with # for new links)
      if (window.history && window.history.pushState) {
        var matchedHash = window.location.hash.match(/^#(\/|%2F)(.*)/);
        if (matchedHash) {
          window.location.replace('/' + matchedHash[2]);
        }
      }
    </script>
  </head>
  <body ng-class="pageClass">
    <div class="wrap">
      <pd-main-menu></pd-main-menu>

      <div class="alert alert-info common-loading-container animated-slide-top"
           ng-show="commonLoadingTracker.active()">
        <span class="glyphicon glyphicon-refresh animated-rotate"></span> Загрузка данных...
      </div>

      <div ng-class="{'container': !setFluidContainer, 'container-fluid': setFluidContainer}">
        <!--[if lt IE 7]>
        <div class="alert alert-danger">
          <span class="glyphicon glyphicon-warning-sign"></span>
          You are using an <strong>outdated</strong> browser.
          Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.
        </div>
        <![endif]-->

        <ui-view autoscroll></ui-view>
      </div>

      <!-- Block for show growl messages -->
      <div growl></div>
    </div>

    <footer class="footer">
      <div class="container">
        <p class="text-muted">&copy; 2013 ПохоронноеДело</p>
      </div>
    </footer>

    <!--[if lt IE 9]>
    <script src="bower_components/es5-shim/es5-shim.js"></script>
    <script src="bower_components/json3/lib/json3.min.js"></script>
    <script src="bower_components/respond/dest/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript" src="//www.google.com/recaptcha/api/js/recaptcha_ajax.js"></script>

    <script src="bower_components/jquery/dist/jquery.js"></script>
    <script src="bower_components/angular/angular.js"></script>
    <script src="bower_components/angular-route/angular-route.js"></script>
    <script src="bower_components/angular-sanitize/angular-sanitize.js"></script>
    <script src="bower_components/angular-animate/angular-animate.js"></script>
    
    <!-- build:js scripts/vendor.js -->
    <!-- bower:js -->
    <script src="bower_components/bootstrap-sass-official/vendor/assets/javascripts/bootstrap.js"></script>
    <script src="bower_components/select2/select2.js"></script>
    <script src="bower_components/angular-ui-select2/src/select2.js"></script>
    <script src="bower_components/angular-bootstrap/ui-bootstrap-tpls.js"></script>
    <script src="bower_components/lodash/dist/lodash.compat.js"></script>
    <script src="bower_components/angular-cookies/angular-cookies.js"></script>
    <script src="bower_components/angularLocalStorage/src/angularLocalStorage.js"></script>
    <script src="bower_components/angular-recaptcha/release/angular-recaptcha.js"></script>
    <script src="bower_components/angular-cookie/angular-cookie.js"></script>
    <script src="bower_components/angular-promise-tracker/promise-tracker.js"></script>
    <script src="bower_components/angular-raven/angular-raven.js"></script>
    <script src="bower_components/angular-growl/build/angular-growl.js"></script>
    <script src="bower_components/ng-file-upload/angular-file-upload.js"></script>
    <script src="bower_components/momentjs/moment.js"></script>
    <script src="bower_components/bootstrap3-typeahead/bootstrap3-typeahead.js"></script>
    <script src="bower_components/checklist-model/checklist-model.js"></script>
    <script src="bower_components/jcarousel/dist/jquery.jcarousel.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
    <script src="bower_components/oauth-js/dist/oauth.min.js"></script>
    <script src="bower_components/angular-seo/angular-seo.js"></script>
    <script src="bower_components/numeral/numeral.js"></script>
    <script src="bower_components/angular-ui-router/release/angular-ui-router.js"></script>
    <!-- endbower -->
    <script src="bower_components/angular-i18n/angular-locale_ru.js"></script>
    <script src="bower_components/select2/select2_locale_ru.js"></script>
    <script src="bower_components/nginfinitescroll/build/ng-infinite-scroll.js"></script>
    <script src="bower_components/angular-yandex-map/example/ya-map.js"></script>
    <script src="bower_components/fancybox/source/jquery.fancybox.js"></script>
    <script src="bower_components/fancybox/source/helpers/jquery.fancybox-thumbs.js"></script>

    <script src="bower_components/angular-strap/dist/modules/date-parser.js"></script>
    <script src="bower_components/angular-strap/dist/modules/dimensions.js"></script>
    <script src="bower_components/angular-strap/dist/modules/tooltip.js"></script>
    <script src="bower_components/angular-strap/dist/modules/tooltip.tpl.js"></script>
    <script src="bower_components/angular-strap/dist/modules/datepicker.js"></script>
    <script src="bower_components/angular-strap/dist/modules/datepicker.tpl.js"></script>
    <script src="bower_components/numeral/languages/ru.js"></script>
    <!-- endbuild -->

    <!-- build:js({.tmp,app}) scripts/scripts.js -->
    <script src="scripts/app.js"></script>
    <script src="scripts/config.js"></script>
    <script src="scripts/config_const.js"></script>
    <script src="scripts/controllers.js"></script>

    <script src="scripts/modules/common/module.js"></script>
    <script src="scripts/modules/common/directive_decorators.js"></script>
    <script src="scripts/modules/common/services/auth.js"></script>
    <script src="scripts/modules/common/services/security.js"></script>
    <script src="scripts/modules/common/services/yandex_api.js"></script>
    <script src="scripts/modules/common/services/main_menu_manager.js"></script>
    <script src="scripts/modules/common/services/object.js"></script>
    <script src="scripts/modules/common/services/api/feedback.js"></script>
    <script src="scripts/modules/common/services/thumbnailer.js"></script>
    <script src="scripts/modules/common/services/file_reader.js"></script>
    <script src="scripts/modules/common/services/modal_notifications.js"></script>
    <script src="scripts/modules/common/services/oauth.js"></script>
    <script src="scripts/modules/common/services/pd_http.js"></script>
    <script src="scripts/modules/common/services/data_providers/org_auth.js"></script>
    <script src="scripts/modules/common/services/seo_service.js"></script>
    <script src="scripts/modules/common/directives/auth.js"></script>
    <script src="scripts/modules/common/directives/sticky_block.js"></script>
    <script src="scripts/modules/common/directives/images.js"></script>
    <script src="scripts/modules/common/directives/navigation.js"></script>
    <script src="scripts/modules/common/directives/form.js"></script>
    <script src="scripts/modules/common/directives/fancybox.js"></script>
    <script src="scripts/modules/common/directives/ya_map.js"></script>
    <script src="scripts/modules/common/directives/scroll.js"></script>
    <script src="scripts/modules/common/directives/carousel.js"></script>
    <script src="scripts/modules/common/filters/default_value.js"></script>
    <script src="scripts/modules/common/filters/text_filters.js"></script>
    <script src="scripts/modules/common/filters/datetime.js"></script>
    <script src="scripts/modules/common/filters/thumbnail.js"></script>
    <script src="scripts/modules/common/filters/money_filter.js"></script>
    <script src="scripts/modules/common/filters/numeral.js"></script>
    <script src="scripts/modules/common/controllers/feedback.js"></script>
    <script src="scripts/modules/common/controllers/org_auth.js"></script>

    <script src="scripts/modules/frontend/module.js"></script>
    <script src="scripts/modules/frontend/controllers/catalog_controller.js"></script>
    <script src="scripts/modules/frontend/controllers/catalog_product_controller.js"></script>
    <script src="scripts/modules/frontend/controllers/map_controller.js"></script>
    <script src="scripts/modules/frontend/controllers/client_panel_controller.js"></script>
    <script src="scripts/modules/frontend/controllers/settings_controller.js"></script>
    <script src="scripts/modules/frontend/controllers/auth_controller.js"></script>
    <script src="scripts/modules/frontend/services/catalog_service.js"></script>
    <script src="scripts/modules/frontend/services/unowned_places_service.js"></script>
    <script src="scripts/modules/frontend/services/places_service.js"></script>
    <script src="scripts/modules/frontend/services/api/catalog_api_service.js"></script>
    <script src="scripts/modules/frontend/services/user.js"></script>
    <script src="scripts/modules/frontend/services/settings.js"></script>

    <script src="scripts/modules/admin/module.js"></script>

    <script src="scripts/modules/loru/module.js"></script>
    <script src="scripts/modules/loru/controllers/productplaces.js"></script>
    <script src="scripts/modules/loru/controllers/orgplaces.js"></script>
    <script src="scripts/modules/loru/services/productplaces.js"></script>
    <script src="scripts/modules/loru/services/orgplaces.js"></script>

    <script src="scripts/modules/oms/module.js"></script>
    <script src="scripts/modules/oms/controllers/placesmap.js"></script>
    <script src="scripts/modules/oms/services/placesmap.js"></script>
    <!-- endbuild -->

    <!-- Sentry logger -->
    <script src="//cdn.ravenjs.com/1.1.9/jquery,native/raven.min.js"></script>
    <script>
      Raven.config('https://82676b8423fa4b58b8274f6116b4645b@app.getsentry.com/19238', {
        logger: 'javascript',
        ignoreErrors: [
          // Random plugins/extensions
          'top.GLOBALS',
          // See: http://blog.errorception.com/2012/03/tale-of-unfindable-js-error. html
          'originalCreateNotification',
          'canvas.contentDocument',
          'MyApp_RemoveAllHighlights',
          'http://tt.epicplay.com',
          'Can\'t find variable: ZiteReader',
          'jigsaw is not defined',
          'ComboSearch is not defined',
          'http://loading.retry.widdit.com/',
          'atomicFindClose',
          // Facebook borked
          'fb_xd_fragment',
          // ISP "optimizing" proxy - `Cache-Control: no-transform` seems to reduce this. (thanks @acdha)
          // See http://stackoverflow.com/questions/4113268/how-to-stop-javascript-injection-from-vodafone-proxy
          'bmi_SafeAddOnload',
          'EBCallBackMessageReceived',
          // See http://toolbar.conduit.com/Developer/HtmlAndGadget/Methods/JSInjection.aspx
          'conduitPage'
        ],
        ignoreUrls: [
          // Facebook flakiness
          /graph\.facebook\.com/i,
          // Facebook blocked
          /connect\.facebook\.net\/en_US\/all\.js/i,
          // Woopra flakiness
          /eatdifferent\.com\.woopra-ns\.com/i,
          /static\.woopra\.com\/js\/woopra\.js/i,
          // Chrome extensions
          /extensions\//i,
          /^chrome:\/\//i,
          // Other plugins
          /127\.0\.0\.1:4001\/isrunning/i,  // Cacaoweb
          /webappstoolbarba\.texthelp\.com\//i,
          /metrics\.itunes\.apple\.com\.edgesuite\.net\//i
        ],
        whitelistUrls: [/pohoronnoedelo\.ru/]
      }).install();
    </script>

    <!-- Yandex.Metrika counter -->
    <!-- build:template:prod
    <script type="text/javascript">
      (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
          try {
            w.yaCounter25697954 = new Ya.Metrika({id:25697954,
              webvisor:true,
              clickmap:true,
              trackLinks:true,
              accurateTrackBounce:true,
              trackHash:true});
          } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
      })(document, window, "yandex_metrika_callbacks");
    </script>
    <noscript><div><img src="//mc.yandex.ru/watch/25697954" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    /build -->
    <!-- /Yandex.Metrika counter -->

    <!-- build:template:prod
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-53329673-1', 'auto');
    </script>
    /build -->
  </body>
</html>
